engine: FHIRConnect/v0.0.1
type: extension
metadata:
  name: KDS_structured_name.v1.person_name-structured_name
  version: 0.0.1-alpha
spec:
  system: FHIR
  version: R4
  extends: CLUSTER.structured_name.v1.person_name-structured_name

mappings:
#  - name: "name.prefix" #TODO is wrong in the template only qualifier is displayed has to be fixed.
#    extension: "overwrite"
#    with:
#      fhir: "$fhirRoot.prefix.extension"
#      openehr: "$openehrRoot/items[at0006]"
#    fhirCondition:
#      targetRoot: "extension"
#      targetAttribute: "url"
#      operator: "one of"
#      criteria: "[http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier]"

  - name: "appendFamily"
    appendTo: "name.familyName"
    followedBy:
      mappings:
        - name: "family"
          with:
            fhir: "family.extension.value"
            openehr: "items[at0005, 'Familienname-Nachname']"
            type: "STRING"
          fhirCondition:
            targetRoot: "family.extension"
            targetAttribute: "url"
            operator: "one of"
            criteria: "[http://hl7.org/fhir/StructureDefinition/humanname-own-name]"

        - name: "namens zusatz"
          with:
            fhir: "family.extension.value"
            openehr: "items[at0005, 'Familienname-Namenszusatz']"
            type: "STRING"
          fhirCondition:
            targetRoot: "family.extension"
            targetAttribute: "url"
            operator: "one of"
            criteria: "[http://fhir.de/StructureDefinition/humanname-namenszusatz]"

        - name: "familienname vorsatzwort"
          with:
            fhir: "family.extension.value"
            openehr: "items[at0005, 'Familienname-Vorsatzwort']"
            type: "STRING"
          fhirCondition:
            targetRoot: "family.extension"
            targetAttribute: "url"
            operator: "one of"
            criteria: "[http://hl7.org/fhir/StructureDefinition/humanname-own-prefix]"

